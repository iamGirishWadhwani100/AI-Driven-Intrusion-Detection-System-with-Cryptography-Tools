<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Integrated Cyber Security Dashboard</title>

    <meta name="description" content="An all-in-one Cyber Suite dashboard featuring a powerful toolkit for security professionals. Includes AI-driven threat detection, hash/password tools, RSA/AES cryptography, and more.">
    <meta name="keywords" content="cyber security, dashboard, toolkit, threat detection, vulnerability scanner, hash generator, cryptography, RSA, AES, password generator, password checker, steganography, security tools, dns fetcher, subnet calculator, magic number, file analysis">
    <meta name="author" content="Cyber Suite Developers">
    <meta name="robots" content="index, follow">

    <meta property="og:title" content="Cyber Suite - Integrated Security Dashboard & Toolkit">
    <meta property="og:description" content="An all-in-one dashboard featuring tools for threat detection, cryptography, password analysis, and more.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://www.example.com/cybersuite"> <meta property="og:image" content="https://www.example.com/images/cyber-suite-preview.png"> <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Cyber Suite - Integrated Security Dashboard & Toolkit">
    <meta name="twitter:description" content="An all-in-one dashboard featuring tools for threat detection, cryptography, password analysis, and more.">
    <meta name="twitter:image" content="https://www.example.com/images/cyber-suite-preview.png"> <script src="https://cdn.tailwindcss.com"></script>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Roboto+Mono:wght@400;700&display=swap" rel="stylesheet">
    
    <script src="https://unpkg.com/@phosphor-icons/web"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jsencrypt/3.3.2/jsencrypt.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/piexifjs/1.0.6/piexif.min.js"></script>

    <style>
        :root {
            --bg-primary: #111827;
            --bg-secondary: #1f2937;
            --bg-tertiary: #374151;
            --border-color: #4b5563;
            --text-primary: #d1d5db;
            --text-secondary: #9ca3af;
            --accent-red: #ef4444;
            --accent-red-hover: #dc2626;
            --accent-green: #22c55e;
            --accent-yellow: #eab308;
            --accent-blue: #3b82f6;
        }

        body { 
            font-family: 'Inter', sans-serif;
            background-color: var(--bg-primary);
            color: var(--text-primary);
        }

        .font-mono {
            font-family: 'Roboto Mono', monospace;
        }

        /* --- Layout & Navigation --- */
        .page-container { display: none; }
        .page-container.active { display: block; }

        .sidebar-link {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.75rem 1rem;
            border-radius: 0.5rem;
            cursor: pointer;
            transition: background-color 0.2s, color 0.2s;
            font-weight: 500;
            color: var(--text-primary);
        }
        .sidebar-link:hover {
            background-color: var(--bg-tertiary);
            color: #ffffff;
        }
        .sidebar-link.active {
            background-color: var(--accent-red);
            color: #ffffff;
            font-weight: 600;
        }
        .sidebar-link i.fa-solid, .sidebar-link i.ph {
            width: 1.25rem;
            text-align: center;
        }

        /* --- Toolkit Component Styles --- */
        .st-subheader {
            font-size: 1.5rem;
            font-weight: 600;
            color: #f3f4f6; /* text-gray-100 */
            border-bottom: 2px solid var(--border-color);
            padding-bottom: 0.5rem;
            margin-top: 2rem;
            margin-bottom: 1.5rem;
        }
        .st-markdown {
            color: var(--text-secondary);
            margin-bottom: 1rem;
        }
        .st-button {
            background-color: var(--accent-red);
            color: white;
            font-weight: 600;
            padding: 0.65rem 1.25rem;
            border-radius: 0.5rem;
            border: none;
            cursor: pointer;
            transition: background-color 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }
        .st-button:hover:not(:disabled) { background-color: var(--accent-red-hover); }
        .st-button:disabled { background-color: var(--bg-tertiary); cursor: not-allowed; }
        
        .st-textarea, .st-input {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid var(--border-color);
            border-radius: 0.5rem;
            background-color: var(--bg-secondary);
            color: var(--text-primary);
            resize: vertical;
        }
        .st-textarea::placeholder, .st-input::placeholder { color: var(--text-secondary); }
        
        .st-code {
            background-color: #000;
            color: #e5e7eb;
            padding: 1rem;
            border-radius: 0.5rem;
            font-family: 'Roboto Mono', monospace;
            white-space: pre-wrap;
            word-break: break-all;
            border: 1px solid var(--bg-tertiary);
            position: relative;
        }
        
        /* Status message styles */
        .st-success, .st-warning, .st-error {
            padding: 1rem;
            border-radius: 0.5rem;
            font-weight: 500;
            margin-top: 1rem;
        }
        .st-success { color: #a7f3d0; background-color: #064e3b; }
        .st-warning { color: #fde68a; background-color: #854d0e; }
        .st-error { color: #fecaca; background-color: #991b1b; }
        
        .st-file-uploader {
            border: 2px dashed var(--border-color);
            border-radius: 0.5rem;
            padding: 2rem;
            text-align: center;
            cursor: pointer;
            background-color: var(--bg-secondary);
            color: var(--text-secondary);
            transition: background-color 0.2s, border-color 0.2s;
        }
        .st-file-uploader.dragover {
             background-color: var(--bg-tertiary);
             border-color: var(--accent-red);
        }
        .st-file-uploader input[type="file"] { display: none; }

        /* Copy Button Styles */
        .copy-btn {
            position: absolute;
            top: 0.5rem;
            right: 0.5rem;
            background-color: var(--bg-tertiary);
            color: var(--text-primary);
            border: none;
            border-radius: 0.375rem;
            padding: 0.25rem 0.5rem;
            cursor: pointer;
            font-size: 0.75rem;
            opacity: 0.6;
            transition: opacity 0.2s, background-color 0.2s;
        }
        .copy-btn:hover {
            opacity: 1;
            background-color: #6b7280;
        }

        /* --- Welcome Page Specific Styles --- */
        .welcome-card {
            background-color: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 0.75rem;
            padding: 1.5rem;
            transition: transform 0.2s, box-shadow 0.2s;
        }
        .welcome-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px -3px rgba(0,0,0,0.3), 0 4px 6px -2px rgba(0,0,0,0.2);
        }
        .news-ticker {
            overflow: hidden;
            background: var(--bg-secondary);
            padding: 0.75rem;
            border-radius: 0.5rem;
            white-space: nowrap;
        }
        .news-ticker-content {
            display: inline-block;
            animation: ticker 30s linear infinite;
        }
        @keyframes ticker {
            0% { transform: translateX(100%); }
            100% { transform: translateX(-100%); }
        }
    </style>
</head>
<body class="flex min-h-screen">

    <aside class="w-72 bg-gray-900 p-4 flex flex-col gap-4 border-r border-gray-700 overflow-y-auto">
        <div class="flex items-center gap-3 p-2 mb-6">
            <i class="ph-duotone ph-shield-check text-4xl text-red-400"></i>
            <div>
                <h1 class="text-xl font-bold text-white">Cyber Suite</h1>
                <p class="text-xs text-gray-400">Dashboard & Toolkit</p>
            </div>
        </div>
        <nav class="flex flex-col gap-2">
            <a class="sidebar-link active" data-target="welcome-page"><i class="ph ph-house"></i> Welcome</a>
            <a class="sidebar-link" data-target="threat-detection-page"><i class="ph ph-shield-warning"></i> Threat Detection</a>
            
            <h3 class="text-xs font-semibold text-gray-500 uppercase tracking-wider mt-4 px-2">Cryptography & Hashes</h3>
            <a class="sidebar-link" data-target="hash-tool-page"><i class="fa-solid fa-hashtag"></i> Hash Generator</a>
            <a class="sidebar-link" data-target="crypto-tool-page"><i class="fa-solid fa-key"></i> Asymmetric (RSA)</a>
            <a class="sidebar-link" data-target="aes-tool-page"><i class="ph ph-lock-key"></i> Symmetric (AES)</a>
            <a class="sidebar-link" data-target="steganography-page"><i class="fa-solid fa-eye-slash"></i> Steganography</a>
            <a class="sidebar-link" data-target="data-converter-page"><i class="ph ph-arrows-left-right"></i> Data Converter</a>
            
            <h3 class="text-xs font-semibold text-gray-500 uppercase tracking-wider mt-4 px-2">Password Toolkit</h3>
            <a class="sidebar-link" data-target="password-generator-page"><i class="fa-solid fa-wand-magic-sparkles"></i> Password Generator</a>
            <a class="sidebar-link" data-target="password-checker-page"><i class="fa-solid fa-shield-halved"></i> Password Checker</a>
            <a class="sidebar-link" data-target="password-breach-page"><i class="fa-solid fa-database"></i> Password Breach Check</a>

            <h3 class="text-xs font-semibold text-gray-500 uppercase tracking-wider mt-4 px-2">Network & Web Utilities</h3>
            <a class="sidebar-link" data-target="url-analyzer-page"><i class="ph ph-link"></i> URL Analyzer</a>
            <a class="sidebar-link" data-target="domain-reputation-page"><i class="ph ph-globe-hemisphere-west"></i> Domain Reputation</a>
            <a class="sidebar-link" data-target="dns-fetcher-page"><i class="ph ph-network"></i> DNS Record Fetcher</a>
            <a class="sidebar-link" data-target="subnet-calculator-page"><i class="ph ph-calculator"></i> Subnet Calculator</a>

            <h3 class="text-xs font-semibold text-gray-500 uppercase tracking-wider mt-4 px-2">Forensic & Analysis Tools</h3>
            <a class="sidebar-link" data-target="exif-viewer-page"><i class="ph ph-image"></i> EXIF Editor</a>
            <a class="sidebar-link" data-target="magic-number-page"><i class="ph ph-file-magnifying-glass"></i> File Signature Analyzer</a>
            <a class="sidebar-link" data-target="string-extractor-page"><i class="ph ph-text-aa"></i> String Extractor</a>

        </nav>
    </aside>

    <main class="flex-1 p-6 lg:p-8 overflow-y-auto">

        <div id="welcome-page" class="page-container active">
            <header class="mb-8">
                <h1 class="text-4xl font-bold text-white">Dashboard</h1>
                <p id="welcome-date" class="text-lg text-gray-400">Thursday, 10 July 2025</p>
            </header>

            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-8">
                <div class="welcome-card lg:col-span-1 flex flex-col justify-center items-center text-center">
                    <h3 class="font-semibold text-gray-300 mb-2 uppercase tracking-wider">Global Cyber Threat</h3>
                    <div id="threat-level-indicator" class="text-6xl font-bold transition-colors duration-500">...</div>
                    <p id="threat-level-desc" class="text-sm text-gray-400 mt-1">Fetching latest intel...</p>
                </div>
                <div class="welcome-card lg:col-span-2">
                    <h3 class="font-semibold text-gray-300 mb-3 uppercase tracking-wider">Quick Access</h3>
                    <div class="grid grid-cols-2 md:grid-cols-3 gap-4">
                        <a data-target="threat-detection-page" class="sidebar-link-card bg-gray-800/50 hover:bg-gray-800 border border-gray-700/50 hover:border-red-500 rounded-lg p-4 flex flex-col items-center text-center transition-all cursor-pointer">
                            <i class="ph ph-shield-warning text-4xl text-red-400 mb-2"></i>
                            <span class="font-semibold text-white">Threat Scan</span>
                        </a>
                        <a data-target="crypto-tool-page" class="sidebar-link-card bg-gray-800/50 hover:bg-gray-800 border border-gray-700/50 hover:border-blue-500 rounded-lg p-4 flex flex-col items-center text-center transition-all cursor-pointer">
                            <i class="fa-solid fa-key text-4xl text-blue-400 mb-2"></i>
                            <span class="font-semibold text-white">Cryptography</span>
                        </a>
                        <a data-target="password-breach-page" class="sidebar-link-card bg-gray-800/50 hover:bg-gray-800 border border-gray-700/50 hover:border-yellow-500 rounded-lg p-4 flex flex-col items-center text-center transition-all cursor-pointer">
                            <i class="fa-solid fa-database text-4xl text-yellow-400 mb-2"></i>
                            <span class="font-semibold text-white">Breach Check</span>
                        </a>
                    </div>
                </div>
            </div>
            
            <div class="mb-8">
                 <h3 class="font-semibold text-gray-300 mb-2 uppercase tracking-wider">Security News Ticker</h3>
                 <div class="news-ticker">
                    <div class="news-ticker-content">
                        <span class="text-red-400 mx-8">ALERT: New zero-day vulnerability discovered in popular web framework...</span>
                        <span class="text-yellow-400 mx-8">ADVISORY: Phishing campaign impersonating financial institutions on the rise...</span>
                        <span class="text-green-400 mx-8">INFO: Global patch for CVE-2025-12345 now available...</span>
                    </div>
                 </div>
            </div>

            <div>
                <h2 class="st-subheader">Full Toolkit</h2>
                <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-4" id="toolkit-grid">
                    <!-- This will be populated by JS -->
                </div>
            </div>
        </div>

        <div id="threat-detection-page" class="page-container">
            <div class="w-full max-w-7xl mx-auto">
                <header class="p-4 flex items-center gap-3 mb-6">
                    <i class="ph-duotone ph-shield-warning text-3xl text-red-400"></i>
                    <div>
                        <h1 class="text-2xl font-bold text-white">AI-Driven Threat Detection & Analysis</h1>
                        <p class="text-gray-400">Correlating vulnerabilities with behavioral anomalies and threat intelligence.</p>
                    </div>
                </header>
        
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                    <div class="lg:col-span-1 flex flex-col gap-6">
                        <section id="scanner">
                            <h2 class="text-lg font-semibold mb-3 text-gray-200">Target Network</h2>
                            <div class="flex flex-col gap-4">
                                <input type="text" id="ip-address" value="192.168.1.1" placeholder="Enter specific IPv4 or IPv6 (e.g., 192.168.1.1 or 2001:0db8::1)" class="flex-grow bg-gray-800 border border-gray-600 rounded-md px-4 py-2 text-white focus:outline-none focus:ring-2 focus:ring-red-500 transition duration-200">
                                 <input type="email" id="recipient-email" placeholder="Email for alerts (e.g., admin@example.com)" class="flex-grow bg-gray-800 border border-gray-600 rounded-md px-4 py-2 text-white focus:outline-none focus:ring-2 focus:ring-red-500 transition duration-200">
                                <button id="scanButton" class="st-button w-full justify-center">
                                    <i class="ph ph-target"></i>
                                    Initiate Deep Scan
                                </button>
                            </div>
                        </section>
                        <section id="summary-section" class="bg-gray-800 p-4 rounded-lg border border-gray-700 hidden">
                            <h2 class="text-lg font-semibold mb-3 text-gray-200 border-b border-gray-600 pb-2">Executive Summary</h2>
                            <div id="summary-content" class="text-sm space-y-3"></div>
                        </section>
                    </div>
        
                    <section id="results-section" class="lg:col-span-2">
                        <h2 class="text-lg font-semibold mb-3 text-gray-200">Live Analysis Log</h2>
                        <div class="bg-gray-900 rounded-md p-4 h-[42rem] overflow-y-auto font-mono text-xs border border-gray-700" id="results-container">
                            <pre id="results" class="whitespace-pre-wrap"></pre>
                            <span id="cursor" class="blinking-cursor hidden">_</span>
                        </div>
                    </section>
                </div>
            </div>
        </div>

        <!-- All other page containers follow here... -->
        <div id="hash-tool-page" class="page-container">
             <div id="hash-tool">
                <h2 class="st-subheader">🔐 Hash Generator</h2>
                <p class="st-markdown">Generate a cryptographic hash for any text or file using <em>MD5, SHA1, or SHA256</em>.</p>
                <div class="space-y-4 max-w-xl">
                    <div>
                        <label class="font-semibold text-gray-200">Hashing Algorithm</label>
                        <select id="hash-algo" class="w-full mt-1 p-2 bg-gray-800 border border-gray-600 rounded-lg">
                            <option>MD5</option>
                            <option>SHA1</option>
                            <option>SHA256</option>
                        </select>
                    </div>
                    <div class="st-radio-group">
                        <input type="radio" id="hash-text-radio" name="hash-input-type" value="text" checked> <label for="hash-text-radio">Text</label>
                        <input type="radio" id="hash-file-radio" name="hash-input-type" value="file"> <label for="hash-file-radio">File</label>
                    </div>
                    <div id="hash-text-input-div">
                        <textarea id="hash-text-input" class="st-textarea font-mono" rows="4" placeholder="Enter Text:"></textarea>
                    </div>
                    <div id="hash-file-input-div" class="hidden">
                        <input type="file" id="hash-file-input" class="w-full text-sm text-gray-400 file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-semibold file:bg-red-600 file:text-white hover:file:bg-red-700">
                    </div>
                    <button id="generate-hash-btn" class="st-button">Generate Hash</button>
                    <div id="hash-output" class="st-code hidden"></div>
                </div>
            </div>
        </div>
        
        <div id="crypto-tool-page" class="page-container">
             <div id="crypto-tool">
                <h2 class="st-subheader">🔑 Asymmetric Cryptography (RSA)</h2>
                <p class="st-markdown">Generate RSA key pairs to encrypt and decrypt messages.</p>
                <h3 class="text-lg font-semibold text-gray-200 mt-6">1. Generate Key Pair</h3>
                <button id="generate-keys-btn" class="st-button mt-2">
                    <i class="fas fa-magic"></i> Generate New 2048-bit RSA Keys
                </button>
                <div id="generation-success" class="st-success hidden mt-4">New key pair generated successfully! Your new keys have been pre-filled below.</div>
                <div id="key-display" class="hidden mt-6 space-y-6">
                    <div>
                        <h4 class="font-semibold mb-2">Public Key</h4>
                        <div class="relative">
                            <textarea id="public-key-area" class="st-textarea" rows="8" readonly placeholder="Public Key"></textarea>
                            <button class="copy-btn" data-copy-target="public-key-area">Copy</button>
                        </div>
                    </div>
                    <div>
                        <h4 class="font-semibold mb-2">Private Key</h4>
                        <div class="relative">
                            <textarea id="private-key-area" class="st-textarea" rows="12" readonly placeholder="Private Key"></textarea>
                             <button class="copy-btn" data-copy-target="private-key-area">Copy</button>
                        </div>
                    </div>
                </div>
                
                <hr class="my-8 border-gray-700">
                
                <div class="grid md:grid-cols-2 gap-8">
                    <div>
                        <h3 class="text-lg font-semibold text-gray-200">2. Encrypt Message</h3>
                        <div class="space-y-4 mt-2">
                            <textarea id="enc-pub-key" class="st-textarea" rows="6" placeholder="Paste Public Key Here"></textarea>
                            <textarea id="msg-to-enc" class="st-textarea" rows="4" placeholder="Message to Encrypt"></textarea>
                            <button id="encrypt-btn" class="st-button">Encrypt</button>
                             <div class="relative">
                                <textarea id="encrypted-output" class="st-textarea" rows="5" placeholder="Encrypted Message (Base64)" readonly></textarea>
                                <button class="copy-btn" data-copy-target="encrypted-output">Copy</button>
                             </div>
                            <div id="encrypt-error" class="st-error hidden"></div>
                        </div>
                    </div>
                    <div>
                        <h3 class="text-lg font-semibold text-gray-200">3. Decrypt Message</h3>
                        <div class="space-y-4 mt-2">
                            <textarea id="dec-priv-key" class="st-textarea" rows="6" placeholder="Paste Private Key Here"></textarea>
                            <textarea id="msg-to-dec" class="st-textarea" rows="4" placeholder="Encrypted Message (Base64)"></textarea>
                            <button id="decrypt-btn" class="st-button">Decrypt</button>
                            <div class="relative">
                                <textarea id="decrypted-output" class="st-textarea" rows="5" placeholder="Decrypted Message" readonly></textarea>
                                <button class="copy-btn" data-copy-target="decrypted-output">Copy</button>
                            </div>
                            <div id="decrypt-success" class="st-success hidden"></div>
                            <div id="decrypt-error" class="st-error hidden"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div id="password-generator-page" class="page-container">
            <div id="password-generator-tool">
                <h2 class="st-subheader">🔐 Secure Password Generator</h2>
                <div class="space-y-4 max-w-md">
                    <div>
                        <label for="pass-length" class="font-semibold">Password Length: <span id="pass-length-val" class="text-red-400 font-bold">16</span></label>
                        <input type="range" id="pass-length" min="8" max="32" value="16" class="w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer">
                    </div>
                    <div class="grid grid-cols-2 gap-4 pt-4">
                        <label class="flex items-center space-x-3"><input type="checkbox" id="use-upper" checked class="h-4 w-4 rounded bg-gray-700 border-gray-600 text-red-600 focus:ring-red-500"> <span>Uppercase (A-Z)</span></label>
                        <label class="flex items-center space-x-3"><input type="checkbox" id="use-lower" checked class="h-4 w-4 rounded bg-gray-700 border-gray-600 text-red-600 focus:ring-red-500"> <span>Lowercase (a-z)</span></label>
                        <label class="flex items-center space-x-3"><input type="checkbox" id="use-digits" checked class="h-4 w-4 rounded bg-gray-700 border-gray-600 text-red-600 focus:ring-red-500"> <span>Numbers (0-9)</span></label>
                        <label class="flex items-center space-x-3"><input type="checkbox" id="use-symbols" checked class="h-4 w-4 rounded bg-gray-700 border-gray-600 text-red-600 focus:ring-red-500"> <span>Symbols (!@#$)</span></label>
                    </div>
                    <button id="generate-pass-btn" class="st-button w-full justify-center">Generate Password</button>
                    <div id="pass-output-container" class="hidden pt-4">
                        <div class="st-success text-center">🎉 Your New Secure Password:</div>
                        <div class="relative">
                            <div id="pass-output" class="st-code text-center mt-2 text-lg"></div>
                            <button class="copy-btn" data-copy-target="pass-output">Copy</button>
                        </div>
                    </div>
                    <div id="pass-warning" class="st-warning hidden"></div>
                </div>
            </div>
        </div>

        <div id="password-checker-page" class="page-container">
            <div id="password-checker-tool">
                <h2 class="st-subheader">🔍 Password Strength Checker</h2>
                <p class="st-markdown">Analyze the strength of a password based on common criteria. (Does not check against breach databases).</p>
                <div class="space-y-4 max-w-md">
                    <input type="password" id="password-to-check" class="st-input" placeholder="Enter password to check...">
                    <div id="strength-results" class="hidden space-y-3 pt-4">
                        <h3 id="strength-text" class="font-bold text-xl text-center"></h3>
                        <div id="strength-suggestions" class="p-4 bg-gray-800 rounded-lg space-y-2"></div>
                    </div>
                </div>
            </div>
        </div>

        <div id="password-breach-page" class="page-container">
            <div id="password-breach-tool">
                <h2 class="st-subheader">🛡️ Password Breach Check</h2>
                <p class="st-markdown">Check if a password has appeared in any known data breaches using the k-anonymity model of Have I Been Pwned. Your full password is <span class="font-bold text-red-400">never</span> sent.</p>
                <div class="max-w-2xl mx-auto">
                    <form id="check-form" class="flex flex-col sm:flex-row items-center gap-3">
                        <div class="relative w-full">
                             <svg class="absolute left-4 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 5.25a3 3 0 013 3m3 0a6 6 0 01-7.029 5.912c-.563-.097-1.159.026-1.563.43L10.5 17.25H8.25v2.25H6v2.25H2.25v-2.818c0-.597.237-1.17.659-1.591l6.499-6.499c.404-.404.527-1 .43-1.563A6 6 0 1121.75 8.25z" /></svg>
                            <input type="password" id="password-input-breach" placeholder="Enter a password to check" required class="w-full bg-gray-800 border border-gray-700 text-white rounded-lg py-3 pl-12 pr-4 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-900 focus:ring-red-500 transition-all">
                        </div>
                        <button type="submit" id="check-button-breach" class="w-full sm:w-auto bg-red-600 hover:bg-red-700 text-white font-bold py-3 px-8 rounded-lg transition-all flex-shrink-0">
                            Check Now
                        </button>
                    </form>
                     <div id="results-area-breach" class="mt-8"></div>
                </div>
            </div>
        </div>

        <div id="steganography-page" class="page-container">
            <div id="steganography-tool">
                <h2 class="st-subheader">🕵️‍♀️ Steganography Tool</h2>
                <p class="st-markdown">Hide a secret message inside a PNG image or reveal a message from an image.</p>
                
                <div class="grid md:grid-cols-2 gap-8">
                    <div id="stego-hide-section" class="space-y-4">
                        <h3 class="text-lg font-semibold text-gray-200">1. Hide Message</h3>
                        <canvas id="hide-canvas" class="hidden"></canvas>
                        <label for="hide-file-input" id="hide-file-uploader" class="st-file-uploader block">
                           <i class="ph ph-upload text-3xl mb-2"></i>
                           <div>Click or drag to upload a PNG Image</div>
                           <input type="file" id="hide-file-input" accept="image/png">
                        </label>
                        <textarea id="secret-message-input" class="st-textarea" placeholder="Enter your secret message here..." rows="4"></textarea>
                        <button id="hide-message-btn" class="st-button" disabled>🔐 Hide Message & Download</button>
                        <div id="hide-error" class="st-error hidden"></div>
                    </div>
                    <div id="stego-reveal-section" class="space-y-4">
                        <h3 class="text-lg font-semibold text-gray-200">2. Reveal Message</h3>
                         <canvas id="reveal-canvas" class="hidden"></canvas>
                        <label for="reveal-file-input" id="reveal-file-uploader" class="st-file-uploader block">
                             <i class="ph ph-file-search text-3xl mb-2"></i>
                             <div>Click or drag to upload a Stego Image</div>
                             <input type="file" id="reveal-file-input" accept="image/png">
                        </label>
                        <button id="reveal-message-btn" class="st-button" disabled>🔍 Reveal Message</button>
                        <div id="reveal-success" class="st-success hidden"></div>
                        <div id="reveal-warning" class="st-warning hidden"></div>
                    </div>
                </div>
            </div>
        </div>

        <div id="url-analyzer-page" class="page-container">
            <div id="url-analyzer-tool">
                <h2 class="st-subheader">🔗 URL Analyzer</h2>
                <p class="st-markdown">Safely inspect a URL by breaking it down into its core components. This helps identify phishing attempts and suspicious links without visiting them.</p>
                <div class="space-y-4 max-w-2xl">
                    <input type="text" id="url-to-parse" class="st-input" placeholder="Paste a full URL (e.g., https://www.example.com/path?id=123)">
                    <button id="parse-url-btn" class="st-button">Analyze URL</button>
                    <div id="url-results-area" class="hidden mt-6"></div>
                </div>
            </div>
        </div>
        
        <div id="data-converter-page" class="page-container">
            <div id="data-converter-tool">
                <h2 class="st-subheader">🔄 Data Converter</h2>
                <p class="st-markdown">A practical utility for encoding and decoding data between common formats.</p>
                <div class="space-y-4 max-w-2xl">
                    <textarea id="converter-input" class="st-textarea font-mono" rows="6" placeholder="Enter data to convert..."></textarea>
                    <div class="flex flex-wrap gap-2">
                        <button class="st-button" id="b64-encode-btn">Base64 Encode</button>
                        <button class="st-button" id="b64-decode-btn">Base64 Decode</button>
                        <button class="st-button" id="url-encode-btn">URL Encode</button>
                        <button class="st-button" id="url-decode-btn">URL Decode</button>
                        <button class="st-button" id="hex-encode-btn">Hex Encode</button>
                        <button class="st-button" id="hex-decode-btn">Hex Decode</button>
                    </div>
                     <div class="relative">
                        <textarea id="converter-output" class="st-textarea font-mono" rows="6" placeholder="Output..." readonly></textarea>
                        <button class="copy-btn" data-copy-target="converter-output">Copy</button>
                    </div>
                    <div id="converter-error" class="st-error hidden"></div>
                </div>
            </div>
        </div>

        <div id="exif-viewer-page" class="page-container">
            <div id="exif-editor-tool">
                <h2 class="st-subheader">🖼️ EXIF Editor</h2>
                <p class="st-markdown">View, add, or update metadata (EXIF tags) within your JPEG image files. Anonymize photos or add your own copyright information.</p>
                 <div class="max-w-2xl mx-auto">
                    <label for="exif-file-input" id="exif-file-uploader" class="st-file-uploader block">
                       <i class="ph ph-image-square text-3xl mb-2"></i>
                       <div>Click or drag to upload a JPEG Image</div>
                       <input type="file" id="exif-file-input" accept="image/jpeg">
                    </label>
                    
                    <div id="exif-main-content" class="hidden mt-6">
                        <h3 class="text-lg font-semibold text-gray-200">1. Current Metadata</h3>
                        <div id="exif-results-area" class="st-code mt-2 max-h-60 overflow-y-auto"></div>
                        
                        <h3 class="text-lg font-semibold text-gray-200 mt-6">2. Add / Update Metadata</h3>
                        <div class="grid sm:grid-cols-2 gap-4 mt-2 p-4 bg-gray-800/50 rounded-lg">
                             <div>
                                <label for="exif-copyright" class="font-medium text-sm">Copyright</label>
                                <input type="text" id="exif-copyright" class="st-input mt-1" placeholder="e.g., 2025 Cyber Suite">
                             </div>
                              <div>
                                <label for="exif-user-comment" class="font-medium text-sm">User Comment</label>
                                <input type="text" id="exif-user-comment" class="st-input mt-1" placeholder="e.g., My custom notes">
                            </div>
                        </div>
                        
                        <div class="mt-6 flex gap-4">
                            <button id="exif-write-btn" class="st-button flex-1 justify-center">
                                <i class="ph ph-download-simple"></i>
                                Apply & Download Image
                            </button>
                             <button id="exif-strip-btn" class="st-button flex-1 justify-center bg-yellow-600 hover:bg-yellow-700">
                                <i class="ph ph-eraser"></i>
                                Strip All & Download
                            </button>
                        </div>
                    </div>

                    <div id="exif-error" class="st-error hidden mt-4"></div>
                </div>
            </div>
        </div>

        <div id="aes-tool-page" class="page-container">
            <div id="aes-tool">
                <h2 class="st-subheader">🔒 Symmetric Encryption (AES-GCM)</h2>
                <p class="st-markdown">Encrypt and decrypt data using the Advanced Encryption Standard (AES). This method uses the same password for both operations.</p>
                <div class="grid md:grid-cols-2 gap-8">
                    <div>
                        <h3 class="text-lg font-semibold text-gray-200">1. Encrypt Data</h3>
                        <div class="space-y-4 mt-2">
                             <textarea id="aes-input-text" class="st-textarea" rows="4" placeholder="Plaintext message"></textarea>
                             <input type="password" id="aes-password-enc" class="st-input" placeholder="Enter a strong password">
                             <button id="aes-encrypt-btn" class="st-button">Encrypt</button>
                             <div class="relative">
                                <textarea id="aes-output-text" class="st-textarea" rows="8" placeholder="Encrypted Output (JSON)" readonly></textarea>
                                <button class="copy-btn" data-copy-target="aes-output-text">Copy</button>
                             </div>
                             <div id="aes-enc-error" class="st-error hidden"></div>
                        </div>
                    </div>
                    <div>
                        <h3 class="text-lg font-semibold text-gray-200">2. Decrypt Data</h3>
                        <div class="space-y-4 mt-2">
                            <textarea id="aes-input-json" class="st-textarea" rows="8" placeholder="Paste the full encrypted JSON output"></textarea>
                            <input type="password" id="aes-password-dec" class="st-input" placeholder="Enter the same password">
                            <button id="aes-decrypt-btn" class="st-button">Decrypt</button>
                             <div class="relative">
                                <textarea id="aes-decrypted-text" class="st-textarea" rows="4" placeholder="Decrypted Message" readonly></textarea>
                                <button class="copy-btn" data-copy-target="aes-decrypted-text">Copy</button>
                            </div>
                             <div id="aes-dec-success" class="st-success hidden"></div>
                             <div id="aes-dec-error" class="st-error hidden"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div id="domain-reputation-page" class="page-container">
            <div id="domain-reputation-tool">
                <h2 class="st-subheader">🌐 Domain Reputation Check (Simulated)</h2>
                <p class="st-markdown">Check a domain or IP against real-world threat intelligence databases. This is a front-end simulation of an API call.</p>
                <div class="space-y-4 max-w-2xl">
                    <input type="text" id="domain-to-check" class="st-input" placeholder="Enter Domain or IP (e.g., example.com or 8.8.8.8)">
                    <button id="check-domain-btn" class="st-button">Check Reputation</button>
                    <div id="domain-results-area" class="hidden mt-6"></div>
                </div>
            </div>
        </div>

        <div id="dns-fetcher-page" class="page-container">
            <div id="dns-fetcher-tool">
                <h2 class="st-subheader">🌐 DNS Record Fetcher</h2>
                <p class="st-markdown">Check a domain's DNS records (A, AAAA, MX, TXT, etc.) using Google's public DNS-over-HTTPS API.</p>
                <div class="space-y-4 max-w-2xl">
                    <input type="text" id="dns-domain-input" class="st-input" placeholder="e.g., google.com">
                    <button id="fetch-dns-btn" class="st-button">Fetch Records</button>
                    <div id="dns-results-area" class="mt-6"></div>
                </div>
            </div>
        </div>

        <div id="subnet-calculator-page" class="page-container">
            <div id="subnet-calculator-tool">
                <h2 class="st-subheader">🧮 Subnet Calculator</h2>
                <p class="st-markdown">Calculate network details from an IP address and CIDR prefix.</p>
                <div class="space-y-4 max-w-2xl">
                    <div class="flex gap-4">
                        <input type="text" id="subnet-ip-input" class="st-input" placeholder="IP Address (e.g., 192.168.10.5)">
                        <input type="number" id="subnet-cidr-input" class="st-input w-24" placeholder="CIDR" min="0" max="32" value="24">
                    </div>
                    <button id="calculate-subnet-btn" class="st-button">Calculate</button>
                    <div id="subnet-results-area" class="hidden mt-6 st-code"></div>
                    <div id="subnet-error-area" class="st-error hidden"></div>
                </div>
            </div>
        </div>

        <div id="magic-number-page" class="page-container">
            <div id="magic-number-tool">
                <h2 class="st-subheader">🔬 File Signature Analyzer</h2>
                <p class="st-markdown">Identify a file's true type by reading its "magic number" (the first few bytes), regardless of its extension.</p>
                 <div class="max-w-2xl mx-auto">
                    <label for="magic-file-input" id="magic-file-uploader" class="st-file-uploader block">
                       <i class="ph ph-file-magnifying-glass text-3xl mb-2"></i>
                       <div>Click or drag to upload any file</div>
                       <input type="file" id="magic-file-input">
                    </label>
                    <div id="magic-results-area" class="hidden mt-6"></div>
                 </div>
            </div>
        </div>

        <div id="string-extractor-page" class="page-container">
            <div id="string-extractor-tool">
                <h2 class="st-subheader">📜 String Extractor</h2>
                <p class="st-markdown">Find and extract human-readable ASCII text from within a binary file.</p>
                 <div class="max-w-3xl mx-auto">
                    <label for="strings-file-input" id="strings-file-uploader" class="st-file-uploader block">
                       <i class="ph ph-text-aa text-3xl mb-2"></i>
                       <div>Click or drag to upload a file to analyze</div>
                       <input type="file" id="strings-file-input">
                    </label>
                    <div class="mt-4">
                        <label for="strings-min-length">Minimum string length:</label>
                        <input type="number" id="strings-min-length" value="4" min="2" class="st-input w-24 ml-2">
                    </div>
                    <div id="strings-results-area" class="hidden st-code mt-6 max-h-96 overflow-y-auto"></div>
                 </div>
            </div>
        </div>

    </main>

    <script>
    document.addEventListener('DOMContentLoaded', () => {
    
        // --- Unified Page Navigation Logic ---
        const sidebarLinks = document.querySelectorAll('.sidebar-link');
        const pageContainers = document.querySelectorAll('.page-container');
        let currentImageBase64 = null; // Used by EXIF editor

        const navigateToPage = (targetId) => {
            // Update active link in sidebar
            sidebarLinks.forEach(l => l.classList.remove('active'));
            document.querySelector(`.sidebar-link[data-target="${targetId}"]`)?.classList.add('active');

            // Update active page content
            pageContainers.forEach(container => {
                if (container.id === targetId) {
                    container.classList.add('active');
                } else {
                    container.classList.remove('active');
                }
            });
        };

        sidebarLinks.forEach(link => {
            link.addEventListener('click', (e) => {
                e.preventDefault();
                const targetId = link.getAttribute('data-target');
                navigateToPage(targetId);
            });
        });
        
        // --- SCRIPT FOR PAGE 1: THREAT DETECTOR (DETERMINISTIC UPDATE) ---
        const scanButton = document.getElementById('scanButton');
        const ipAddressInput = document.getElementById('ip-address');
        const resultsDiv = document.getElementById('results');
        const cursor = document.getElementById('cursor');
        const summarySection = document.getElementById('summary-section');
        const summaryContent = document.getElementById('summary-content');
        const recipientEmailInput = document.getElementById('recipient-email');

        if(scanButton) {
            scanButton.addEventListener('click', startScan);
            ipAddressInput.addEventListener('keypress', (e) => e.key === 'Enter' && startScan());
        }

        function startScan() {
            const targetIp = ipAddressInput.value.trim();
            const email = recipientEmailInput.value.trim();

            const ipv4Regex = /^((25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/;
            const ipv6Regex = /^([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}$|^((([0-9a-fA-F]{1,4}:){0,6}[0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:){0,6}[0-9a-fA-F]{1,4})?$/;

            if (!ipv4Regex.test(targetIp) && !ipv6Regex.test(targetIp)) {
                resultsDiv.innerHTML = `<span class="text-red-500">Error: Invalid IP address. Please use a valid IPv4 (e.g., 192.168.1.1) or IPv6 (e.g., 2001:0db8::1) address.</span>`;
                return;
            }
            if (email && !/^\S+@\S+\.\S+$/.test(email)) {
                 resultsDiv.innerHTML = `<span class="text-red-500">Error: Please enter a valid email address for alerts.</span>`;
                 return;
            }

            resultsDiv.textContent = '';
            scanButton.disabled = true;
            scanButton.innerHTML = '<i class="ph ph-spinner-gap animate-spin"></i> Analyzing...';
            cursor.classList.remove('hidden');
            summarySection.classList.add('hidden');
            simulateSystemScan(targetIp);
        }

        // This function creates a consistent, repeatable "random" number based on a seed string.
        // This makes the scan results deterministic for a given IP address.
        function getDeterministicRandom(seed) {
            let hash = 0;
            if (seed.length === 0) return hash;
            for (let i = 0; i < seed.length; i++) {
                const char = seed.charCodeAt(i);
                hash = ((hash << 5) - hash) + char;
                hash |= 0; // Convert to 32bit integer
            }
            // Normalize to a positive value between 0 and 1
            const normalized = (hash & 0x7FFFFFFF) / 0x7FFFFFFF;
            return normalized;
        }

        async function simulateSystemScan(targetIp) {
            const resultsContainer = document.getElementById('results-container');
            let totalRiskScore = 0;
            let criticalThreatsCount = 0;
            
            const addLine = (text, delay = 50) => {
                return new Promise(resolve => {
                    setTimeout(() => {
                        const line = document.createElement('div');
                        line.innerHTML = text;
                        resultsDiv.appendChild(line);
                        resultsContainer.scrollTop = resultsContainer.scrollHeight;
                        resolve();
                    }, Math.random() * delay + 20); // Random delay for visual effect
                });
            };

            await addLine(`<span class="text-cyan-400">> AI Engine Initialized. Target: ${targetIp}</span>`);
            await addLine(`<span class="text-gray-500">> Phase 1: Host Discovery...</span>`, 1000);
            
            const discoveredHosts = [{ip: targetIp, riskScore: 0, criticalThreats: 0}];

            await addLine(`<span class="text-green-400">> Discovery Complete. Analyzing 1 active host.</span>`);

            for (const host of discoveredHosts) {
                await addLine(`\n<span class="text-cyan-400">--- Analyzing Host: ${host.ip} ---</span>`);
                const { hostRisk, criticalCount } = await analyzeHost(host, addLine);
                host.riskScore = hostRisk;
                host.criticalThreats = criticalCount;
                totalRiskScore += hostRisk;
                criticalThreatsCount += criticalCount;
            }

            await addLine(`\n<span class="text-cyan-400">> System-wide analysis complete. Generating executive summary...</span>`);
            const summaryObject = generateSummary(discoveredHosts, totalRiskScore, criticalThreatsCount);

            if (recipientEmailInput.value.trim()) {
                await addLine(`\n<span class="text-blue-400">> Attempting to send alert email...</span>`);
                await sendAlertsToServer(summaryObject, addLine);
            }

            scanButton.disabled = false;
            scanButton.innerHTML = '<i class="ph ph-target"></i> Initiate Deep Scan';
            cursor.classList.add('hidden');
        }

        async function analyzeHost(host, addLine) {
            let hostRisk = 0;
            let criticalCount = 0;
            const vulnerabilityDB = [
                { port: 23, service: 'Telnet', severity: 'Critical', threat: "Cleartext login protocol.", intel: "Actively exploited by Mirai botnet variants.", advice: "Disable Telnet, use SSH.", risk: 25 },
                { port: 445, service: 'SMB', severity: 'Critical', threat: "Exposed file sharing service.", intel: "Primary vector for ransomware like WannaCry/NotPetya.", advice: "Firewall from internet. Patch against EternalBlue.", risk: 30 },
                { port: 3389, service: 'RDP', severity: 'Critical', threat: "Exposed Remote Desktop.", intel: "High-value target for brute-force and credential theft.", advice: "Use VPN/MFA. Enable NLA.", risk: 25 },
                { port: 21, service: 'FTP', severity: 'High', threat: "Anonymous FTP enabled.", intel: "Often used for malware staging.", advice: "Disable anonymous login. Use SFTP.", risk: 15 },
                { port: 5900, service: 'VNC', severity: 'High', threat: "Unencrypted remote desktop.", intel: "Susceptible to session hijacking.", advice: "Tunnel over SSH or use secure alternative.", risk: 15 },
                { port: 8080, service: 'Proxy', severity: 'Medium', threat: "Open HTTP proxy.", intel: "Can be abused for outbound attacks.", advice: "Restrict access to authorized users.", risk: 10 }
            ];
            const behavioralIOCs = [
                { name: "Unusual Outbound Traffic", intel: "Host communicating with known C2 server in North Korea.", risk: 40, severity: 'Critical' },
                { name: "Multiple Failed Logins", intel: "Brute-force attempt detected from multiple IPs.", risk: 20, severity: 'High' },
                { name: "Powershell Execution without Arguments", intel: "Common technique for fileless malware.", risk: 25, severity: 'High' },
                { name: "Data Exfiltration Pattern Detected", intel: "Large volume of compressed data sent to an unknown external IP.", risk: 50, severity: 'Critical' }
            ];
            
            await addLine(`<span class="text-gray-500">> Phase 2.1: Vulnerability Scanning for ${host.ip}...</span>`);
            await addLine(`<span class="text-gray-500">>   - Probing common TCP/UDP ports...</span>`, 300);
            for (const vuln of vulnerabilityDB) {
                const vulnSeed = `${host.ip}:${vuln.service}`;
                if (getDeterministicRandom(vulnSeed) > 0.75) {
                    const sevColor = { 'Critical': 'text-red-500', 'High': 'text-yellow-400', 'Medium': 'text-blue-400' }[vuln.severity];
                    await addLine(`<span class="${sevColor}">[VULN]</span> Port ${vuln.port} (${vuln.service}) - <span class="font-bold">${vuln.severity}</span>`);
                    await addLine(`  <span class="text-gray-400">└─ <i class="ph-fill ph-warning-diamond text-yellow-500"></i> <span class="font-semibold">Threat:</span> ${vuln.threat}</span>`);
                    await addLine(`  <span class="text-gray-400">└─ <i class="ph-fill ph-radioactive text-red-500"></i> <span class="font-semibold">Intel:</span> ${vuln.intel}</span>`);
                    await addLine(`  <span class="text-gray-400">└─ <i class="ph-fill ph-lifebuoy text-green-500"></i> <span class="font-semibold">Advice:</span> ${vuln.advice}</span>`);
                    hostRisk += vuln.risk;
                    if(vuln.severity === 'Critical') criticalCount++;
                }
            }
            await addLine(`<span class="text-gray-500">>   - Port scan complete.</span>`, 200);


            await addLine(`<span class="text-gray-500">> Phase 2.2: Behavioral Anomaly Detection for ${host.ip}...</span>`);
            await addLine(`<span class="text-gray-500">>   - Correlating network traffic with threat intelligence feeds...</span>`, 300);
             for (const ioc of behavioralIOCs) {
                const iocSeed = `${host.ip}:${ioc.name}`;
                if (getDeterministicRandom(iocSeed) > 0.85) {
                    const sevColor = { 'Critical': 'text-red-500', 'High': 'text-yellow-400' }[ioc.severity];
                    await addLine(`<span class="${sevColor}">[BEHAVIOR]</span> ${ioc.name} - <span class="font-bold">${ioc.severity}</span>`);
                    await addLine(`  <span class="text-gray-400">└─ <i class="ph-fill ph-radioactive text-red-500"></i> <span class="font-semibold">Intel:</span> ${ioc.intel}</span>`);
                    hostRisk += ioc.risk;
                    if(ioc.severity === 'Critical') criticalCount++;
                }
            }
            await addLine(`<span class="text-gray-500">>   - Behavioral analysis complete.</span>`, 200);

            
            const riskColor = hostRisk > 50 ? 'bg-red-900 text-red-300' : hostRisk > 20 ? 'bg-yellow-900 text-yellow-300' : 'bg-green-900 text-green-300';
            await addLine(`<span class="px-2 py-1 rounded ${riskColor}">Host Risk Score for ${host.ip}: ${hostRisk}</span>`);
            return { hostRisk, criticalCount };
        }

        function generateSummary(hosts, totalRisk, criticalThreats) {
            summarySection.classList.remove('hidden');
            let posture, postureColor;
            const avgRisk = hosts.length > 0 ? totalRisk / hosts.length : 0;
            if (avgRisk > 40 || criticalThreats > 2) { posture = "COMPROMISED"; postureColor = "text-red-500"; } 
            else if (avgRisk > 15 || criticalThreats > 0) { posture = "AT RISK"; postureColor = "text-yellow-400"; }
            else { posture = "SECURE"; postureColor = "text-green-400"; }
            
            const summaryObject = {
                hostsScanned: hosts.length,
                criticalThreats: criticalThreats,
                averageRisk: avgRisk.toFixed(0),
                networkPosture: posture,
                priorityTargets: hosts.sort((a, b) => b.riskScore - a.riskScore).slice(0, 3).map(h => ({ip: h.ip, risk: h.riskScore}))
            };

            let summaryHTML = `
                <div class="flex justify-between items-center"><span>Hosts Scanned:</span> <span class="font-bold">${summaryObject.hostsScanned}</span></div>
                <div class="flex justify-between items-center"><span>Critical Threats:</span> <span class="font-bold text-red-500">${summaryObject.criticalThreats}</span></div>
                <div class="flex justify-between items-center"><span>Avg. Host Risk:</span> <span class="font-bold">${summaryObject.averageRisk}</span></div>
                <div class="mt-4 pt-2 border-t border-gray-700">
                    <div class="flex justify-between items-center"><span>Network Posture:</span> <span class="font-bold ${postureColor}">${summaryObject.networkPosture}</span></div>
                </div>
                <h3 class="font-semibold mt-4 text-gray-300">Priority Targets:</h3>
                <ul class="list-none space-y-1 mt-1">`;
            summaryObject.priorityTargets.forEach(h => {
                 const riskColor = h.risk > 50 ? 'text-red-400' : h.risk > 20 ? 'text-yellow-400' : 'text-green-400';
                summaryHTML += `<li class="flex justify-between items-center"><span><i class="ph ph-desktop-tower"></i> ${h.ip}</span> <span class="font-bold ${riskColor}">Risk: ${h.risk}</span></li>`;
            });
            summaryHTML += '</ul>';
            summaryContent.innerHTML = summaryHTML;

            return summaryObject;
        }
        
        async function sendAlertsToServer(summary, addLine) {
            const backendUrl = 'https://ai-driven-intrusion-detection-syste.vercel.app/send-alert';
            const summaryText = `Cyber Suite Scan Report: Network Posture: ${summary.networkPosture}, Critical Threats: ${summary.criticalThreats}, Avg Risk: ${summary.averageRisk}`;

            try {
                const response = await fetch(backendUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ recipientEmail: recipientEmailInput.value.trim(), summaryText: summaryText }),
                });
                if (response.ok) { await addLine(`<span class="text-green-400">> Alert sent successfully to server.</span>`); } 
                else { await addLine(`<span class="text-red-500">> Failed to send alerts. Server responded with status: ${response.status}.</span>`); }
            } catch (error) {
                console.error('Failed to connect to the backend server:', error);
                 await addLine(`<span class="text-red-500">> Failed to send alerts. Could not connect to backend at ${backendUrl}.</span>`);
                 await addLine(`<span class="text-yellow-400">> Note: This feature requires a running backend service to send emails.</span>`);
            }
        }

        // --- SCRIPT FOR HASH GENERATOR ---
        const hashAlgo = document.getElementById('hash-algo');
        const hashTextInput = document.getElementById('hash-text-input');
        const hashFileInput = document.getElementById('hash-file-input');
        const generateHashBtn = document.getElementById('generate-hash-btn');
        const hashOutput = document.getElementById('hash-output');
        if(generateHashBtn) {
            document.querySelectorAll('input[name="hash-input-type"]').forEach(radio => {
                radio.addEventListener('change', e => {
                    document.getElementById('hash-text-input-div').classList.toggle('hidden', e.target.value !== 'text');
                    document.getElementById('hash-file-input-div').classList.toggle('hidden', e.target.value !== 'file');
                });
            });
            
            generateHashBtn.addEventListener('click', async () => {
                const algo = hashAlgo.value === 'MD5' ? 'MD5' : `SHA-${hashAlgo.value.substring(3)}`;
                const isText = document.getElementById('hash-text-radio').checked;
                let data;
                let outputContent = '';

                try {
                    if (isText) {
                        if (!hashTextInput.value) { outputContent = 'Error: Text input is empty.';}
                        else { data = new TextEncoder().encode(hashTextInput.value); }
                    } else {
                        if (!hashFileInput.files.length) { outputContent = 'Error: No file selected.';}
                        else { data = await hashFileInput.files[0].arrayBuffer(); }
                    }

                    if(data) {
                        if (algo === 'MD5') {
                             outputContent = 'MD5 is considered insecure and is not supported by the standard Web Crypto API.';
                        } else {
                            const hashBuffer = await crypto.subtle.digest(algo, data);
                            const hashArray = Array.from(new Uint8Array(hashBuffer));
                            const hashHex = hashArray.map(b => b.toString(16).padStart(2, '0')).join('');
                            outputContent = hashHex;
                        }
                    }
                } catch (error) {
                    outputContent = `An error occurred: ${error.message}`;
                }

                if(outputContent) {
                    hashOutput.innerHTML = `<button class="copy-btn" data-copy-target="hash-output-content">Copy</button><span id="hash-output-content">${outputContent}</span>`;
                    hashOutput.classList.remove('hidden');
                } else {
                    hashOutput.classList.add('hidden');
                }
            });
        }

        // --- SCRIPT FOR CRYPTOGRAPHY TOOL ---
        const generateKeysBtn = document.getElementById('generate-keys-btn');
        if(generateKeysBtn) {
            const keyDisplay = document.getElementById('key-display');
            const generationSuccess = document.getElementById('generation-success');
            const publicKeyArea = document.getElementById('public-key-area');
            const privateKeyArea = document.getElementById('private-key-area');
            const encPubKeyInput = document.getElementById('enc-pub-key');
            const decPrivKeyInput = document.getElementById('dec-priv-key');
            const encryptBtn = document.getElementById('encrypt-btn');
            const decryptBtn = document.getElementById('decrypt-btn');

            generateKeysBtn.addEventListener('click', () => {
                const crypt = new JSEncrypt({ default_key_size: 2048 });
                const privateKey = crypt.getPrivateKey();
                const publicKey = crypt.getPublicKey();
                publicKeyArea.value = publicKey;
                privateKeyArea.value = privateKey;
                encPubKeyInput.value = publicKey;
                decPrivKeyInput.value = privateKey;
                keyDisplay.classList.remove('hidden');
                generationSuccess.classList.remove('hidden');
            });

            encryptBtn.addEventListener('click', () => {
                const crypt = new JSEncrypt();
                crypt.setPublicKey(document.getElementById('enc-pub-key').value);
                const encrypted = crypt.encrypt(document.getElementById('msg-to-enc').value);
                const errorDiv = document.getElementById('encrypt-error');
                if (encrypted) {
                     document.getElementById('encrypted-output').value = encrypted;
                     errorDiv.classList.add('hidden');
                } else {
                     document.getElementById('encrypted-output').value = '';
                     errorDiv.textContent = 'Encryption failed. Ensure the public key is valid.';
                     errorDiv.classList.remove('hidden');
                }
            });

            decryptBtn.addEventListener('click', () => {
                const crypt = new JSEncrypt();
                crypt.setPrivateKey(document.getElementById('dec-priv-key').value);
                const decrypted = crypt.decrypt(document.getElementById('msg-to-dec').value);
                const successDiv = document.getElementById('decrypt-success');
                const errorDiv = document.getElementById('decrypt-error');
                if (decrypted) {
                    document.getElementById('decrypted-output').value = decrypted;
                    successDiv.textContent = 'Decryption Successful!';
                    successDiv.classList.remove('hidden');
                    errorDiv.classList.add('hidden');
                } else {
                    document.getElementById('decrypted-output').value = '';
                    errorDiv.textContent = 'Decryption failed. Ensure the private key is correct and the message is valid.';
                    errorDiv.classList.remove('hidden');
                    successDiv.classList.add('hidden');
                }
            });
        }

        // --- SCRIPT FOR PASSWORD GENERATOR ---
        const generatePassBtn = document.getElementById('generate-pass-btn');
        if(generatePassBtn) {
            const passLengthSlider = document.getElementById('pass-length');
            const passLengthVal = document.getElementById('pass-length-val');
            const useUpper = document.getElementById('use-upper');
            const useLower = document.getElementById('use-lower');
            const useDigits = document.getElementById('use-digits');
            const useSymbols = document.getElementById('use-symbols');

            const savePassGenSettings = () => {
                const settings = {
                    length: passLengthSlider.value,
                    upper: useUpper.checked,
                    lower: useLower.checked,
                    digits: useDigits.checked,
                    symbols: useSymbols.checked,
                };
                localStorage.setItem('passwordGeneratorSettings', JSON.stringify(settings));
            };
            
            passLengthSlider.addEventListener('input', () => {
                passLengthVal.textContent = passLengthSlider.value;
                savePassGenSettings();
            });
            [useUpper, useLower, useDigits, useSymbols].forEach(el => el.addEventListener('change', savePassGenSettings));
            
            generatePassBtn.addEventListener('click', () => {
                const length = parseInt(passLengthSlider.value);
                const passOutputContainer = document.getElementById('pass-output-container');
                const passOutput = document.getElementById('pass-output');
                const passWarning = document.getElementById('pass-warning');

                const upperChars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
                const lowerChars = 'abcdefghijklmnopqrstuvwxyz';
                const digitChars = '0123456789';
                const symbolChars = '!@#$%^&*()_+~`|}{[]:;?><,./-=';
                let charset = '';
                if (useUpper.checked) charset += upperChars;
                if (useLower.checked) charset += lowerChars;
                if (useDigits.checked) charset += digitChars;
                if (useSymbols.checked) charset += symbolChars;
                
                if (!charset) {
                    passWarning.textContent = '⚠ Please select at least one character type.';
                    passWarning.classList.remove('hidden');
                    passOutputContainer.classList.add('hidden');
                    return;
                }
                passWarning.classList.add('hidden');

                let password = '';
                for (let i = 0; i < length; i++) {
                    password += charset.charAt(Math.floor(Math.random() * charset.length));
                }
                passOutput.textContent = password;
                passOutputContainer.classList.remove('hidden');
            });
        }

        // --- SCRIPT FOR PASSWORD CHECKER ---
        const passwordToCheck = document.getElementById('password-to-check');
        if(passwordToCheck) {
            passwordToCheck.addEventListener('input', () => {
                const password = passwordToCheck.value;
                const resultsDiv = document.getElementById('strength-results');
                if (!password) {
                    resultsDiv.classList.add('hidden');
                    return;
                }
                resultsDiv.classList.remove('hidden');

                let score = 0;
                const suggestions = [];
                if (password.length >= 12) { score += 2; } 
                else if (password.length >= 8) { score++; }
                if (/[a-z]/.test(password)) { score++; }
                if (/[A-Z]/.test(password)) { score++; }
                if (/\d/.test(password)) { score++; }
                if (/[^A-Za-z0-9]/.test(password)) { score++; }

                if (password.length < 8) { suggestions.push("❌ Too short! Minimum 8 characters recommended."); }
                else if (password.length < 12) { suggestions.push("💡 Good! Aim for 12+ characters for even better strength."); }
                if (!/[a-z]/.test(password)) { suggestions.push("🔡 Add some lowercase letters."); }
                if (!/[A-Z]/.test(password)) { suggestions.push("🔠 Add some uppercase letters."); }
                if (!/\d/.test(password)) { suggestions.push("🔢 Add some numbers."); }
                if (!/[^A-Za-z0-9]/.test(password)) { suggestions.push("💥 Add some special characters (!@#$)."); }

                let strength = "";
                let strengthColor = "";
                if (score <= 2) { strength = "💀 Very Weak"; strengthColor = "text-red-500"; } 
                else if (score <= 3) { strength = "⚠ Weak"; strengthColor = "text-yellow-500"; } 
                else if (score <= 4) { strength = "✅ Good"; strengthColor = "text-blue-400"; }
                else { strength = "🛡 Excellent"; strengthColor = "text-green-400"; }

                const strengthTextEl = document.getElementById('strength-text');
                strengthTextEl.textContent = `Strength: ${strength}`;
                strengthTextEl.className = `font-bold text-xl text-center ${strengthColor}`;
                
                const suggestionsEl = document.getElementById('strength-suggestions');
                suggestionsEl.innerHTML = '';
                if (suggestions.length > 0 && password.length > 0) {
                    suggestions.forEach(tip => {
                        const p = document.createElement('p');
                        p.textContent = tip;
                        p.className = 'text-gray-300';
                        suggestionsEl.appendChild(p);
                    });
                } else if (password.length > 0) {
                     const p = document.createElement('p');
                     p.innerHTML = '✅ Your password meets all the recommended criteria!';
                     p.className = 'text-green-400 font-semibold';
                     suggestionsEl.appendChild(p);
                }
            });
        }
        
        // --- SCRIPT FOR STEGANOGRAPHY ---
        const hideCanvas = document.getElementById('hide-canvas');
        if(hideCanvas) { 
            const revealCanvas = document.getElementById('reveal-canvas');
            const hideFileInput = document.getElementById('hide-file-input');
            const revealFileInput = document.getElementById('reveal-file-input');
            const hideFileUploader = document.getElementById('hide-file-uploader');
            const revealFileUploader = document.getElementById('reveal-file-uploader');
            const secretMessageInput = document.getElementById('secret-message-input');
            const hideMessageBtn = document.getElementById('hide-message-btn');
            const revealMessageBtn = document.getElementById('reveal-message-btn');
            const hideError = document.getElementById('hide-error');
            const revealSuccess = document.getElementById('reveal-success');
            const revealWarning = document.getElementById('reveal-warning');

            const MESSAGE_DELIMITER = "::STEGO_END::";

            const handleFileUpload = (e, canvas, btn) => {
                const file = e.target.files[0];
                if (file && file.type === 'image/png') {
                    const reader = new FileReader();
                    reader.onload = (event) => {
                        const img = new Image();
                        img.onload = () => {
                            const ctx = canvas.getContext('2d');
                            canvas.width = img.width;
                            canvas.height = img.height;
                            ctx.drawImage(img, 0, 0);
                            btn.disabled = false;
                        };
                        img.src = event.target.result;
                    };
                    reader.readAsDataURL(file);
                } else {
                    alert('Please select a valid PNG file.');
                    btn.disabled = true;
                }
            };
            
            hideFileInput.addEventListener('change', (e) => handleFileUpload(e, hideCanvas, hideMessageBtn));
            revealFileInput.addEventListener('change', (e) => handleFileUpload(e, revealCanvas, revealMessageBtn));
            
            ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
                hideFileUploader.addEventListener(eventName, e => { e.preventDefault(); e.stopPropagation(); }, false);
                revealFileUploader.addEventListener(eventName, e => { e.preventDefault(); e.stopPropagation(); }, false);
            });
            ['dragenter', 'dragover'].forEach(eventName => {
                hideFileUploader.addEventListener(eventName, () => hideFileUploader.classList.add('dragover'));
                revealFileUploader.addEventListener(eventName, () => revealFileUploader.classList.add('dragover'));
            });
            ['dragleave', 'drop'].forEach(eventName => {
                hideFileUploader.addEventListener(eventName, () => hideFileUploader.classList.remove('dragover'));
                revealFileUploader.addEventListener(eventName, () => revealFileUploader.classList.remove('dragover'));
            });

            hideFileUploader.addEventListener('drop', (e) => {
                hideFileInput.files = e.dataTransfer.files;
                handleFileUpload({ target: hideFileInput }, hideCanvas, hideMessageBtn);
            });
             revealFileUploader.addEventListener('drop', (e) => {
                revealFileInput.files = e.dataTransfer.files;
                handleFileUpload({ target: revealFileInput }, revealCanvas, revealMessageBtn);
            });
            
            hideMessageBtn.addEventListener('click', () => {
                const message = secretMessageInput.value;
                if (!message) {
                    hideError.textContent = 'Please enter a message to hide.';
                    hideError.classList.remove('hidden');
                    return;
                }
                
                const messageWithDelimiter = message + MESSAGE_DELIMITER;
                let messageInBinary = '';
                for (let i = 0; i < messageWithDelimiter.length; i++) {
                    messageInBinary += messageWithDelimiter[i].charCodeAt(0).toString(2).padStart(8, '0');
                }

                const ctx = hideCanvas.getContext('2d');
                const imageData = ctx.getImageData(0, 0, hideCanvas.width, hideCanvas.height);
                const data = imageData.data;

                if (messageInBinary.length > data.length / 4 * 3) {
                     hideError.textContent = 'Message is too long for this image.';
                     hideError.classList.remove('hidden');
                     return;
                }
                
                let dataIndex = 0;
                for(let i = 0; i < messageInBinary.length; i++) {
                    const bit = parseInt(messageInBinary[i]);
                    if ((dataIndex + 1) % 4 === 0) { dataIndex++; } 
                    data[dataIndex] = (data[dataIndex] & 0xFE) | bit; 
                    dataIndex++;
                }
                
                ctx.putImageData(imageData, 0, 0);

                const link = document.createElement('a');
                link.download = 'stego-image.png';
                link.href = hideCanvas.toDataURL('image/png');
                link.click();
                hideError.classList.add('hidden');
            });
            
            revealMessageBtn.addEventListener('click', () => {
                const ctx = revealCanvas.getContext('2d');
                const imageData = ctx.getImageData(0, 0, revealCanvas.width, revealCanvas.height);
                const data = imageData.data;
                
                let binaryMessage = '';
                let revealedMessage = '';

                for (let i = 0; i < data.length; i++) {
                    if ((i + 1) % 4 === 0) continue;
                    
                    binaryMessage += (data[i] & 1).toString();
                    
                    if (binaryMessage.length === 8) {
                        const char = String.fromCharCode(parseInt(binaryMessage, 2));
                        revealedMessage += char;
                        
                        if (revealedMessage.endsWith(MESSAGE_DELIMITER)) {
                            const finalMessage = revealedMessage.slice(0, -MESSAGE_DELIMITER.length);
                            revealSuccess.innerHTML = `<strong>Hidden Message Found:</strong><br><pre class="mt-2 whitespace-pre-wrap">${finalMessage}</pre>`;
                            revealSuccess.classList.remove('hidden');
                            revealWarning.classList.add('hidden');
                            return;
                        }
                        binaryMessage = '';
                    }
                }
                
                revealWarning.textContent = '⚠ No valid hidden message found in this image.';
                revealWarning.classList.remove('hidden');
                revealSuccess.classList.add('hidden');
            });
        }
         // --- SCRIPT FOR PASSWORD BREACH CHECKER ---
        const checkFormBreach = document.getElementById('check-form');
        if(checkFormBreach) {
            const passwordInputBreach = document.getElementById('password-input-breach');
            const checkButtonBreach = document.getElementById('check-button-breach');
            const resultsAreaBreach = document.getElementById('results-area-breach');

            checkFormBreach.addEventListener('submit', (event) => {
                event.preventDefault();
                handleBreachCheck();
            });

            const handleBreachCheck = async () => {
                const passwordToCheck = passwordInputBreach.value;

                if (!passwordToCheck) {
                    displayBreachError('Please enter a password to check.');
                    return;
                }

                setBreachLoadingState(true);

                try {
                    const hashBuffer = await crypto.subtle.digest('SHA-1', new TextEncoder().encode(passwordToCheck));
                    const hashHex = Array.from(new Uint8Array(hashBuffer)).map(b => b.toString(16).padStart(2, '0')).join('').toUpperCase();
                    const prefix = hashHex.substring(0, 5);
                    const suffix = hashHex.substring(5);

                    const response = await fetch(`https://api.pwnedpasswords.com/range/${prefix}`);
                    
                    if (!response.ok) {
                        throw new Error(`API error: ${response.statusText}`);
                    }

                    const text = await response.text();
                    const match = findMatchInResponse(text, suffix);
                    
                    if (match) {
                        displayPwnedResult(match.count);
                    } else {
                        displaySafeResult();
                    }
                } catch (error) {
                    displayBreachError('An error occurred. Please check the console for details.');
                    console.error('Error checking password:', error);
                } finally {
                    setBreachLoadingState(false);
                }
            };

            const findMatchInResponse = (responseText, suffixToFind) => {
                const lines = responseText.split('\n');
                for (const line of lines) {
                    const [hashSuffix, count] = line.split(':');
                    if (hashSuffix === suffixToFind) {
                        return { count: parseInt(count, 10) };
                    }
                }
                return null;
            };

            const setBreachLoadingState = (isLoading) => {
                checkButtonBreach.disabled = isLoading;
                if (isLoading) {
                    checkButtonBreach.innerHTML = '<i class="ph ph-spinner-gap animate-spin"></i> Checking...';
                    resultsAreaBreach.innerHTML = `
                        <div class="text-center text-gray-400">
                            <div class="inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-red-400"></div>
                            <p class="mt-2">Securely checking password...</p>
                        </div>
                    `;
                } else {
                    checkButtonBreach.innerHTML = 'Check Now';
                }
            };
            
            const displayPwnedResult = (count) => {
                resultsAreaBreach.innerHTML = `
                    <div class="bg-red-900/20 border border-red-500/30 rounded-xl p-6">
                        <div class="flex items-center gap-4">
                            <svg class="w-10 h-10 text-red-400 flex-shrink-0" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126z" />
                            </svg>
                            <div>
                                <h3 class="text-2xl font-bold text-red-300">Oh no — Pwned!</h3>
                                <p class="text-red-300/80">This password has been seen <strong class="text-red-200">${count.toLocaleString()}</strong> times before.</p>
                            </div>
                        </div>
                        <div class="mt-6 bg-red-800/50 p-4 rounded-lg text-red-200">
                            <p><strong>This password is not secure!</strong> You should avoid using it anywhere, as it is publicly known and makes your accounts easy targets.</p>
                        </div>
                    </div>
                `;
            };

            const displaySafeResult = () => {
                resultsAreaBreach.innerHTML = `
                    <div class="bg-green-900/20 border border-green-500/30 rounded-xl p-6">
                        <div class="flex items-center gap-4">
                            <svg class="w-10 h-10 text-green-400 flex-shrink-0" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                            </svg>
                            <div>
                                <h3 class="text-2xl font-bold text-green-300">Good news — password not found!</h3>
                                <p class="text-green-300/80">This password was not found in the database of known leaks.</p>
                            </div>
                        </div>
                         <div class="mt-4 bg-green-800/50 p-4 rounded-lg text-green-200">
                            <p><strong>Stay vigilant:</strong> This doesn't guarantee the password is "strong", only that it hasn't appeared in a known breach. Continue to follow password best practices.</p>
                        </div>
                    </div>
                `;
            };
            
            const displayBreachError = (message) => {
                resultsAreaBreach.innerHTML = `
                    <div class="bg-yellow-900/20 border border-yellow-500/30 rounded-xl p-4 text-center">
                        <p class="text-yellow-300">${message}</p>
                    </div>
                `;
            }
        }

        // --- URL ANALYZER SCRIPT ---
        const parseUrlBtn = document.getElementById('parse-url-btn');
        if(parseUrlBtn){
            const urlInput = document.getElementById('url-to-parse');
            const urlResultsArea = document.getElementById('url-results-area');

            const analyze = () => {
                const urlString = urlInput.value.trim();
                urlResultsArea.classList.add('hidden');
                urlResultsArea.innerHTML = '';
                if (!urlString) return;

                try {
                    const urlWithProtocol = /^(?:f|ht)tps?:\/\//.test(urlString) ? urlString : `http://${urlString}`;
                    const url = new URL(urlWithProtocol);
                    
                    let warnings = [];
                    if (/^(\d{1,3}\.){3}\d{1,3}$/.test(url.hostname)) {
                        warnings.push({ text: 'Hostname is an IP address. Legitimate sites rarely use raw IPs.', level: 'high' });
                    }
                    if (url.hostname.includes('@')) {
                         warnings.push({ text: 'Hostname contains an "@" symbol, a common phishing trick.', level: 'high' });
                    }
                    if (url.hostname.length > 50) {
                         warnings.push({ text: 'Hostname is unusually long.', level: 'medium' });
                    }

                    let paramsHTML = '';
                    if(Array.from(url.searchParams).length > 0) {
                        paramsHTML = `
                            <h4 class="font-semibold text-gray-300 mt-3">Query Parameters:</h4>
                            <div class="mt-1 space-y-1 text-sm">
                        `;
                        url.searchParams.forEach((value, key) => {
                            paramsHTML += `<div class="flex"><span class="w-1/3 font-mono text-cyan-400">${key}</span><span class="flex-1 font-mono text-gray-400 break-all">${value}</span></div>`;
                        });
                        paramsHTML += '</div>';
                    }
                    
                    let warningsHTML = '';
                    if (warnings.length > 0) {
                        warningsHTML = `<h4 class="font-semibold text-red-400 mt-4">Warnings:</h4>`;
                        warnings.forEach(w => {
                            warningsHTML += `<p class="text-yellow-400 text-sm mt-1">🚨 ${w.text}</p>`;
                        });
                    }

                    urlResultsArea.innerHTML = `
                        <div class="st-code space-y-2">
                            <div><span class="w-24 inline-block text-red-400">Protocol:</span> <span class="font-semibold">${url.protocol}</span></div>
                            <div><span class="w-24 inline-block text-red-400">Hostname:</span> <span class="font-semibold">${url.hostname}</span></div>
                            <div><span class="w-24 inline-block text-red-400">Port:</span> <span class="font-semibold">${url.port || (url.protocol === 'https:' ? '443' : '80')}</span></div>
                            <div><span class="w-24 inline-block text-red-400">Path:</span> <span class="font-semibold break-all">${url.pathname}</span></div>
                        </div>
                        ${paramsHTML}
                        ${warningsHTML}
                    `;
                    urlResultsArea.classList.remove('hidden');

                } catch (e) {
                    urlResultsArea.innerHTML = `<div class="st-error">Invalid URL. Please enter a full and valid URL.</div>`;
                    urlResultsArea.classList.remove('hidden');
                }
            }
            parseUrlBtn.addEventListener('click', analyze);
            urlInput.addEventListener('keypress', (e) => e.key === 'Enter' && analyze());
        }

        // --- DATA CONVERTER SCRIPT ---
        const converterInput = document.getElementById('converter-input');
        if (converterInput) {
            const output = document.getElementById('converter-output');
            const errorDiv = document.getElementById('converter-error');

            const runConversion = (conversionFunc) => {
                const inputData = converterInput.value;
                if (!inputData) {
                    output.value = '';
                    errorDiv.classList.add('hidden');
                    return;
                }
                try {
                    output.value = conversionFunc(inputData);
                    errorDiv.classList.add('hidden');
                } catch (e) {
                    output.value = '';
                    errorDiv.textContent = `Error: ${e.message}. Invalid input for this conversion type.`;
                    errorDiv.classList.remove('hidden');
                }
            };

            document.getElementById('b64-encode-btn').addEventListener('click', () => runConversion(d => btoa(d)));
            document.getElementById('b64-decode-btn').addEventListener('click', () => runConversion(d => atob(d)));
            document.getElementById('url-encode-btn').addEventListener('click', () => runConversion(d => encodeURIComponent(d)));
            document.getElementById('url-decode-btn').addEventListener('click', () => runConversion(d => decodeURIComponent(d)));
            document.getElementById('hex-encode-btn').addEventListener('click', () => runConversion(d => {
                return Array.from(d).map(c => c.charCodeAt(0).toString(16).padStart(2, '0')).join('');
            }));
            document.getElementById('hex-decode-btn').addEventListener('click', () => runConversion(d => {
                let str = '';
                for (let i = 0; i < d.length; i += 2) {
                    str += String.fromCharCode(parseInt(d.substr(i, 2), 16));
                }
                return str;
            }));
        }

        // --- EXIF EDITOR SCRIPT ---
        const exifFileInput = document.getElementById('exif-file-input');
        if (exifFileInput) {
            const mainContent = document.getElementById('exif-main-content');
            const resultsArea = document.getElementById('exif-results-area');
            const errorDiv = document.getElementById('exif-error');
            const copyrightInput = document.getElementById('exif-copyright');
            const commentInput = document.getElementById('exif-user-comment');
            const writeBtn = document.getElementById('exif-write-btn');
            const stripBtn = document.getElementById('exif-strip-btn');

            exifFileInput.addEventListener('change', (e) => {
                const file = e.target.files[0];
                if (!file) {
                    mainContent.classList.add('hidden');
                    return;
                }
                if (file.type !== 'image/jpeg') {
                    errorDiv.textContent = 'Error: Please upload a JPEG file to edit EXIF data.';
                    errorDiv.classList.remove('hidden');
                    mainContent.classList.add('hidden');
                    return;
                }

                const reader = new FileReader();
                reader.onload = (event) => {
                    currentImageBase64 = event.target.result;
                    errorDiv.classList.add('hidden');
                    mainContent.classList.remove('hidden');
                    
                    const exifData = piexif.load(currentImageBase64);
                    let html = '';
                    let tagCount = 0;
                    for (const ifd in exifData) {
                        if (ifd == 'thumbnail') continue;
                        for (const tag in exifData[ifd]) {
                            const tagName = piexif.TAGS[ifd][tag]["name"];
                            const tagValue = exifData[ifd][tag];
                            html += `<div class="flex"><span class="w-1/3 font-mono text-cyan-400">${tagName}</span><span class="flex-1 font-mono text-gray-400 break-all">${tagValue}</span></div>`;
                            tagCount++;
                        }
                    }

                    resultsArea.innerHTML = tagCount > 0 ? html : '<p class="text-gray-400">No EXIF data found in this image.</p>';
                    copyrightInput.value = exifData["0th"][piexif.ImageIFD.Copyright] || '';
                    commentInput.value = exifData["Exif"][piexif.ExifIFD.UserComment] || '';
                };
                reader.readAsDataURL(file);
            });

            const processAndDownload = (strip) => {
                if (!currentImageBase64) return;
                
                let exifData;
                if(strip) {
                    exifData = {};
                } else {
                    exifData = piexif.load(currentImageBase64);
                    const copyright = copyrightInput.value.trim();
                    const comment = commentInput.value.trim();

                    if (copyright) {
                        exifData["0th"][piexif.ImageIFD.Copyright] = copyright;
                    } else {
                        delete exifData["0th"][piexif.ImageIFD.Copyright];
                    }
                    
                    if (comment) {
                        exifData["Exif"][piexif.ExifIFD.UserComment] = comment;
                    } else {
                        delete exifData["Exif"][piexif.ExifIFD.UserComment];
                    }
                }
                
                const exifBytes = piexif.dump(exifData);
                const newBase64 = piexif.insert(exifBytes, currentImageBase64);

                const link = document.createElement('a');
                link.href = newBase64;
                link.download = strip ? 'image-stripped.jpg' : 'image-edited.jpg';
                link.click();
            };

            writeBtn.addEventListener('click', () => processAndDownload(false));
            stripBtn.addEventListener('click', () => processAndDownload(true));
        }
        
        // --- AES ENCRYPTION SCRIPT ---
        const aesEncryptBtn = document.getElementById('aes-encrypt-btn');
        if (aesEncryptBtn) {
            const aesDecryptBtn = document.getElementById('aes-decrypt-btn');
            const textEncoder = new TextEncoder();
            const textDecoder = new TextDecoder();
            
            const bufferToBase64 = (buf) => btoa(String.fromCharCode.apply(null, new Uint8Array(buf)));
            const base64ToBuffer = (b64) => Uint8Array.from(atob(b64), c => c.charCodeAt(0));

            const getAesKey = async (password, salt) => {
                const keyMaterial = await crypto.subtle.importKey(
                    'raw',
                    textEncoder.encode(password),
                    'PBKDF2',
                    false,
                    ['deriveKey']
                );
                return crypto.subtle.deriveKey(
                    { name: 'PBKDF2', salt: salt, iterations: 100000, hash: 'SHA-256' },
                    keyMaterial,
                    { name: 'AES-GCM', length: 256 },
                    true,
                    ['encrypt', 'decrypt']
                );
            };

            aesEncryptBtn.addEventListener('click', async () => {
                const inputText = document.getElementById('aes-input-text').value;
                const password = document.getElementById('aes-password-enc').value;
                const outputArea = document.getElementById('aes-output-text');
                const errorDiv = document.getElementById('aes-enc-error');

                if (!inputText || !password) {
                    errorDiv.textContent = "Please provide both a message and a password.";
                    errorDiv.classList.remove('hidden');
                    return;
                }
                errorDiv.classList.add('hidden');

                try {
                    const salt = crypto.getRandomValues(new Uint8Array(16));
                    const iv = crypto.getRandomValues(new Uint8Array(12));
                    const key = await getAesKey(password, salt);
                    
                    const encryptedBuffer = await crypto.subtle.encrypt(
                        { name: 'AES-GCM', iv: iv },
                        key,
                        textEncoder.encode(inputText)
                    );
                    
                    const output = {
                        ct: bufferToBase64(encryptedBuffer),
                        salt: bufferToBase64(salt),
                        iv: bufferToBase64(iv)
                    };
                    
                    outputArea.value = JSON.stringify(output, null, 2);
                } catch(e) {
                    errorDiv.textContent = `Encryption failed: ${e.message}`;
                    errorDiv.classList.remove('hidden');
                }
            });

            aesDecryptBtn.addEventListener('click', async () => {
                const inputJson = document.getElementById('aes-input-json').value;
                const password = document.getElementById('aes-password-dec').value;
                const outputArea = document.getElementById('aes-decrypted-text');
                const errorDiv = document.getElementById('aes-dec-error');
                const successDiv = document.getElementById('aes-dec-success');
                
                errorDiv.classList.add('hidden');
                successDiv.classList.add('hidden');
                outputArea.value = '';

                if (!inputJson || !password) {
                    errorDiv.textContent = "Please provide the encrypted JSON and the password.";
                    errorDiv.classList.remove('hidden');
                    return;
                }

                try {
                    const { ct, salt, iv } = JSON.parse(inputJson);
                    const key = await getAesKey(password, base64ToBuffer(salt));
                    const decryptedBuffer = await crypto.subtle.decrypt(
                        { name: 'AES-GCM', iv: base64ToBuffer(iv) },
                        key,
                        base64ToBuffer(ct)
                    );
                    
                    outputArea.value = textDecoder.decode(decryptedBuffer);
                    successDiv.textContent = "Decryption Successful!";
                    successDiv.classList.remove('hidden');
                } catch(e) {
                    errorDiv.textContent = `Decryption failed. Check password or data format.`;
                    errorDiv.classList.remove('hidden');
                }
            });
        }
        
        // --- DOMAIN REPUTATION (SIMULATED) SCRIPT ---
        const checkDomainBtn = document.getElementById('check-domain-btn');
        if (checkDomainBtn) {
            const domainInput = document.getElementById('domain-to-check');
            const resultsArea = document.getElementById('domain-results-area');

            checkDomainBtn.addEventListener('click', () => {
                const domain = domainInput.value.trim().toLowerCase();
                resultsArea.classList.add('hidden');
                if (!domain) return;
                
                const seed = getDeterministicRandom(domain);
                
                let report;
                if (seed > 0.9) {
                    report = { status: 'Malicious', color: 'red', icon: 'ph-skull', lists: ['PhishTank', 'Spamhaus ZEN', 'Known C2 Host'], details: 'This domain is actively associated with phishing campaigns and malware distribution.' };
                } else if (seed > 0.7) {
                    report = { status: 'Suspicious', color: 'yellow', icon: 'ph-warning', lists: ['Newly Registered Domain', 'Uses Free TLD'], details: 'This domain exhibits characteristics common to malicious sites. Proceed with caution.' };
                } else {
                    report = { status: 'Clean', color: 'green', icon: 'ph-check-circle', lists: [], details: 'This domain has no known negative reputation across major threat intelligence feeds.' };
                }
                
                let listsHTML = '';
                if (report.lists.length > 0) {
                    listsHTML = `<p class="mt-2 text-sm text-gray-400">Flagged by: ${report.lists.join(', ')}</p>`;
                }

                resultsArea.innerHTML = `
                    <div class="border border-${report.color}-500/30 bg-${report.color}-900/20 rounded-lg p-4">
                        <div class="flex items-center gap-3">
                             <i class="ph ${report.icon} text-3xl text-${report.color}-400"></i>
                            <div>
                                <h3 class="font-bold text-xl text-${report.color}-300">${report.status}</h3>
                                <p class="text-${report.color}-300/80">${domain}</p>
                            </div>
                        </div>
                        <p class="mt-3 text-gray-300">${report.details}</p>
                        ${listsHTML}
                    </div>
                `;
                resultsArea.classList.remove('hidden');
            });
            domainInput.addEventListener('keypress', (e) => e.key === 'Enter' && checkDomainBtn.click());
        }

        // --- WELCOME DASHBOARD SCRIPT ---
        const welcomePage = document.getElementById('welcome-page');
        if (welcomePage) {
            const toolkitGrid = document.getElementById('toolkit-grid');
            if (toolkitGrid) {
                sidebarLinks.forEach(link => {
                    if (link.dataset.target !== 'welcome-page') {
                        const card = document.createElement('a');
                        card.href = "#";
                        card.className = "sidebar-link-card bg-gray-800/50 hover:bg-gray-800 border border-gray-700/50 hover:border-gray-500 rounded-lg p-4 flex items-center gap-3 transition-all cursor-pointer";
                        card.dataset.target = link.dataset.target;
                        card.innerHTML = `${link.innerHTML.replace('class="ph', 'class="text-xl ph').replace('class="fa-solid', 'class="text-xl fa-solid')} <span class="font-semibold text-sm">${link.textContent}</span>`;
                        toolkitGrid.appendChild(card);
                    }
                });
            }

            document.querySelectorAll('.sidebar-link-card').forEach(card => {
                card.addEventListener('click', (e) => {
                    e.preventDefault();
                    navigateToPage(card.getAttribute('data-target'));
                });
            });

            const indicator = document.getElementById('threat-level-indicator');
            const desc = document.getElementById('threat-level-desc');
            const level = Math.random();
            if (level > 0.8) {
                indicator.textContent = 'SEVERE';
                indicator.className += ' text-red-500';
                desc.textContent = 'Active global threats detected. High vigilance required.';
            } else if (level > 0.5) {
                indicator.textContent = 'HIGH';
                indicator.className += ' text-yellow-400';
                desc.textContent = 'Elevated threat activity observed. Stay cautious.';
            } else {
                 indicator.textContent = 'GUARDED';
                 indicator.className += ' text-green-400';
                 desc.textContent = 'Normal activity levels. Standard precautions advised.';
            }
            
            // Set current date
            const dateEl = document.getElementById('welcome-date');
            if(dateEl) {
                dateEl.textContent = new Date().toLocaleDateString('en-US', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' });
            }
        }

        // --- DNS FETCHER SCRIPT ---
        const fetchDnsBtn = document.getElementById('fetch-dns-btn');
        if (fetchDnsBtn) {
            const domainInput = document.getElementById('dns-domain-input');
            const resultsArea = document.getElementById('dns-results-area');

            const fetchRecords = async () => {
                const domain = domainInput.value.trim();
                if (!domain) return;
                
                resultsArea.innerHTML = `<div class="text-center text-gray-400 mt-4">Fetching...</div>`;
                const recordTypes = ['A', 'AAAA', 'MX', 'TXT', 'NS', 'CNAME'];
                let resultsHTML = '';

                for (const type of recordTypes) {
                    try {
                        const response = await fetch(`https://dns.google/resolve?name=${domain}&type=${type}`);
                        const data = await response.json();
                        
                        if (data.Answer) {
                            resultsHTML += `<h3 class="text-lg font-semibold text-gray-200 mt-4">${type} Records</h3><div class="st-code mt-2">`;
                            data.Answer.forEach(record => {
                                resultsHTML += `<div>${record.data}</div>`;
                            });
                            resultsHTML += '</div>';
                        }
                    } catch (e) {
                        console.error(`Failed to fetch ${type} for ${domain}`, e);
                    }
                }
                resultsArea.innerHTML = resultsHTML || `<div class="st-warning">No records found for "${domain}".</div>`;
            };

            fetchDnsBtn.addEventListener('click', fetchRecords);
            domainInput.addEventListener('keypress', (e) => e.key === 'Enter' && fetchRecords());
        }

        // --- SUBNET CALCULATOR SCRIPT ---
        const calculateSubnetBtn = document.getElementById('calculate-subnet-btn');
        if (calculateSubnetBtn) {
            const ipInput = document.getElementById('subnet-ip-input');
            const cidrInput = document.getElementById('subnet-cidr-input');
            const resultsArea = document.getElementById('subnet-results-area');
            const errorArea = document.getElementById('subnet-error-area');

            const ipToLong = ip => ip.split('.').reduce((acc, octet) => (acc << 8) + parseInt(octet, 10), 0) >>> 0;
            const longToIp = long => [(long >>> 24), (long >>> 16) & 0xFF, (long >>> 8) & 0xFF, long & 0xFF].join('.');

            const calculate = () => {
                errorArea.classList.add('hidden');
                try {
                    const ip = ipInput.value;
                    const cidr = parseInt(cidrInput.value, 10);
                    if (!/^((\d{1,3}\.){3}\d{1,3})$/.test(ip) || cidr < 0 || cidr > 32) {
                        throw new Error('Invalid IP address or CIDR prefix.');
                    }
                    
                    const ipLong = ipToLong(ip);
                    const mask = (0xFFFFFFFF << (32 - cidr)) >>> 0;
                    
                    const networkLong = ipLong & mask;
                    const broadcastLong = networkLong | (~mask >>> 0);
                    
                    const networkAddr = longToIp(networkLong);
                    const broadcastAddr = longToIp(broadcastLong);
                    const firstHost = longToIp(networkLong + 1);
                    const lastHost = longToIp(broadcastLong - 1);
                    const totalHosts = Math.pow(2, 32 - cidr);
                    
                    resultsArea.innerHTML = `
                        <div><span class="w-40 inline-block text-cyan-400">Network Address:</span> ${networkAddr}</div>
                        <div><span class="w-40 inline-block text-cyan-400">Broadcast Address:</span> ${broadcastAddr}</div>
                        <div><span class="w-40 inline-block text-cyan-400">Usable Host Range:</span> ${firstHost} - ${lastHost}</div>
                        <div><span class="w-40 inline-block text-cyan-400">Total Hosts:</span> ${totalHosts.toLocaleString()}</div>
                        <div><span class="w-40 inline-block text-cyan-400">Usable Hosts:</span> ${(totalHosts > 2 ? totalHosts - 2 : 0).toLocaleString()}</div>
                        <div><span class="w-40 inline-block text-cyan-400">Subnet Mask:</span> ${longToIp(mask)}</div>
                    `;
                    resultsArea.classList.remove('hidden');

                } catch (e) {
                    errorArea.textContent = e.message;
                    errorArea.classList.remove('hidden');
                    resultsArea.classList.add('hidden');
                }
            };
            calculateSubnetBtn.addEventListener('click', calculate);
        }
        
        // --- FILE SIGNATURE "MAGIC NUMBER" ANALYZER ---
        const magicFileInput = document.getElementById('magic-file-input');
        if (magicFileInput) {
            const resultsArea = document.getElementById('magic-results-area');
            const uploader = document.getElementById('magic-file-uploader');

            const FILE_SIGNATURES = {
                '89504e47': { ext: 'PNG', mime: 'image/png', desc: 'PNG image file' },
                'ffd8ffe0': { ext: 'JPG/JPEG', mime: 'image/jpeg', desc: 'JPEG image file' },
                '47494638': { ext: 'GIF', mime: 'image/gif', desc: 'GIF image file' },
                '25504446': { ext: 'PDF', mime: 'application/pdf', desc: 'Adobe PDF document' },
                '504b0304': { ext: 'ZIP', mime: 'application/zip', desc: 'ZIP archive' },
                '4d5a': { ext: 'EXE/DLL', mime: 'application/x-msdownload', desc: 'Windows executable or library' },
                '7f454c46': { ext: 'ELF', mime: 'application/octet-stream', desc: 'Linux executable' },
            };

            const handleMagicFile = (file) => {
                if (!file) return;
                const reader = new FileReader();
                reader.onload = (e) => {
                    const buffer = new Uint8Array(e.target.result);
                    let hex = '';
                    for (let i = 0; i < buffer.length; i++) {
                        hex += buffer[i].toString(16).padStart(2, '0');
                    }
                    
                    let match = null;
                    for (const sig in FILE_SIGNATURES) {
                        if (hex.startsWith(sig)) {
                            match = FILE_SIGNATURES[sig];
                            break;
                        }
                    }
                    
                    let resultHTML = `<div class="st-code"><p>File Name: ${file.name}</p><p>File Size: ${file.size.toLocaleString()} bytes</p><p>Reported MIME Type: ${file.type || 'N/A'}</p><hr class="my-2 border-gray-600"><p>First 8 Bytes (Hex): <span class="font-mono">${hex}</span></p>`;

                    if(match) {
                        resultHTML += `<div class="mt-4 p-4 bg-green-900/50 rounded-lg"><h4 class="font-bold text-lg text-green-300">✅ Match Found: ${match.ext}</h4><p class="text-green-400">${match.desc}</p><p class="text-sm text-gray-400">Probable MIME: ${match.mime}</p></div>`;
                    } else {
                         resultHTML += `<div class="mt-4 p-4 bg-yellow-900/50 rounded-lg"><h4 class="font-bold text-lg text-yellow-300">⚠️ No Definitive Match</h4><p class="text-yellow-400">The file signature does not match common types in the database. It may be a plain text file, a custom binary format, or an unknown type.</p></div>`;
                    }
                    resultHTML += '</div>';
                    resultsArea.innerHTML = resultHTML;
                    resultsArea.classList.remove('hidden');
                };
                reader.readAsArrayBuffer(file.slice(0, 8));
            };

            magicFileInput.addEventListener('change', (e) => handleMagicFile(e.target.files[0]));
            uploader.addEventListener('drop', (e) => { e.preventDefault(); handleMagicFile(e.dataTransfer.files[0]); });
            ['dragenter', 'dragover', 'dragleave'].forEach(evt => uploader.addEventListener(evt, e => e.preventDefault()));
        }

        // --- STRING EXTRACTOR SCRIPT ---
        const stringsFileInput = document.getElementById('strings-file-input');
        if (stringsFileInput) {
            const resultsArea = document.getElementById('strings-results-area');
            const minLengthInput = document.getElementById('strings-min-length');
            const uploader = document.getElementById('strings-file-uploader');

            const handleStringsFile = (file) => {
                if (!file) return;
                resultsArea.textContent = 'Analyzing...';
                resultsArea.classList.remove('hidden');

                const reader = new FileReader();
                reader.onload = (e) => {
                    const buffer = new Uint8Array(e.target.result);
                    let result = '';
                    let currentString = '';
                    const minLength = parseInt(minLengthInput.value) || 4;

                    for (let i = 0; i < buffer.length; i++) {
                        const charCode = buffer[i];
                        if (charCode >= 32 && charCode <= 126) {
                            currentString += String.fromCharCode(charCode);
                        } else {
                            if (currentString.length >= minLength) {
                                result += currentString + '\n';
                            }
                            currentString = '';
                        }
                    }
                    if (currentString.length >= minLength) { result += currentString; }

                    resultsArea.textContent = result || 'No readable strings found with the specified minimum length.';
                };
                reader.readAsArrayBuffer(file);
            };

            stringsFileInput.addEventListener('change', (e) => handleStringsFile(e.target.files[0]));
            uploader.addEventListener('drop', (e) => { e.preventDefault(); handleStringsFile(e.dataTransfer.files[0]); });
            ['dragenter', 'dragover', 'dragleave'].forEach(evt => uploader.addEventListener(evt, e => e.preventDefault()));
        }

        // --- UX: COPY TO CLIPBOARD ---
        document.body.addEventListener('click', (e) => {
            const copyBtn = e.target.closest('.copy-btn');
            if (copyBtn) {
                const targetId = copyBtn.dataset.copyTarget;
                const targetElement = document.getElementById(targetId);
                let textToCopy = '';

                if (targetElement) {
                    if (targetElement.tagName === 'TEXTAREA' || targetElement.tagName === 'INPUT') {
                        textToCopy = targetElement.value;
                    } else if(targetId === 'hash-output-content') {
                         textToCopy = targetElement.textContent;
                    } else {
                         textToCopy = targetElement.textContent;
                    }
                }
                
                if (textToCopy) {
                    navigator.clipboard.writeText(textToCopy).then(() => {
                        const originalText = copyBtn.textContent;
                        copyBtn.textContent = 'Copied!';
                        setTimeout(() => { copyBtn.textContent = originalText; }, 2000);
                    }).catch(err => console.error('Failed to copy: ', err));
                }
            }
        });


        // --- PERSISTENT SETTINGS (LOCALSTORAGE) ---
        const loadSettings = () => {
            const lastScanSettings = JSON.parse(localStorage.getItem('threatScannerSettings'));
            if(lastScanSettings && ipAddressInput && recipientEmailInput){
                ipAddressInput.value = lastScanSettings.ip || '192.168.1.1';
                recipientEmailInput.value = lastScanSettings.email || '';
            }

            const lastPassGenSettings = JSON.parse(localStorage.getItem('passwordGeneratorSettings'));
            if (lastPassGenSettings) {
                const { length, upper, lower, digits, symbols } = lastPassGenSettings;
                const passLengthSlider = document.getElementById('pass-length');
                if (passLengthSlider) {
                    passLengthSlider.value = length;
                    document.getElementById('pass-length-val').textContent = length;
                    document.getElementById('use-upper').checked = upper;
                    document.getElementById('use-lower').checked = lower;
                    document.getElementById('use-digits').checked = digits;
                    document.getElementById('use-symbols').checked = symbols;
                }
            }
        };

        const saveThreatScannerSettings = () => {
            if (ipAddressInput && recipientEmailInput) {
                const settings = {
                    ip: ipAddressInput.value,
                    email: recipientEmailInput.value,
                };
                localStorage.setItem('threatScannerSettings', JSON.stringify(settings));
            }
        };
        
        if (ipAddressInput && recipientEmailInput) {
            ipAddressInput.addEventListener('change', saveThreatScannerSettings);
            recipientEmailInput.addEventListener('change', saveThreatScannerSettings);
        }

        loadSettings();
    });
    </script>
</body>
</html>
